export CLUSTER_NAME="elasticluster"

export SCHEDULER_TYPE={% if "slurm_master" in group_names %}SLURM{% endif %}{% if "pbs_master" in group_names %}PBS{% endif%}{% if "slurm_worker" in group_names %}SLURM{% endif %}{% if "pbs_worker" in group_names %}PBS{% endif%}

export IDENTITY_TYPE="NIS"    #default

export NODE_ROLE={% if "slurm_master" in group_names %}"M,T"{% endif %}{% if "pbs_master" in group_names %}"M,T"
{% endif%}{% if "slurm_worker" in group_names %}"E"{% endif %}{% if "pbs_worker" in group_names %}"E"{% endif%}

export NODE_PASSWORD=""

export COMPUTE_IPLIST=
{% if "slurm_master" in group_names %}
{% for host in groups['slurm_worker']%}
={{hostvars[host].ansible_default_ipv4.address}}
{% endfor -%}
{% endif %}
{% if "pbs_master" in group_names %}
{% for host in groups['pbs_worker']%}
={{hostvars[host].ansible_default_ipv4.address}}
{% endfor -%}
{% endif %}
{% if "slurm_worker" in group_names %}
{% for host in groups['slurm_worker']%}
={{hostvars[host].ansible_default_ipv4.address}}
{% endfor -%}
{% endif %}
{% if "pbs_worker" in group_names %}
{% for host in groups['pbs_worker']%}
={{hostvars[host].ansible_default_ipv4.address}}
{% endfor -%}
{% endif %}

export NODE_IP={{hostvars[inventory_hostname]['ansible_default_ipv4']['address']}}

export LOGIN_IP=
{% if "slurm_master" in group_names %}
{% for host in groups['slurm_master']%}
={{hostvars[host].ansible_default_ipv4.address}}
{% endfor -%}
{% endif %}
{% if "pbs_master" in group_names %}
{% for host in groups['pbs_master']%}
={{hostvars[host].ansible_default_ipv4.address}}
{% endfor -%}
{% endif %}
{% if "slurm_worker" in group_names %}
{% for host in groups['slurm_master']%}
={{hostvars[host].ansible_default_ipv4.address}}
{% endfor -%}
{% endif %}
{% if "pbs_worker" in group_names %}
{% for host in groups['pbs_master']%}
={{hostvars[host].ansible_default_ipv4.address}}
{% endfor -%}
{% endif %}

export MANAGER_IP=
{% if "slurm_master" in group_names %}
{% for host in groups['slurm_master']%}
={{hostvars[host].ansible_default_ipv4.address}}
{% endfor -%}
{% endif %}
{% if "pbs_master" in group_names %}
{% for host in groups['pbs_master']%}
={{hostvars[host].ansible_default_ipv4.address}}
{% endfor -%}
{% endif %}
{% if "slurm_worker" in group_names %}
{% for host in groups['slurm_master']%}
={{hostvars[host].ansible_default_ipv4.address}}
{% endfor -%}
{% endif %}
{% if "pbs_worker" in group_names %}
{% for host in groups['pbs_master']%}
={{hostvars[host].ansible_default_ipv4.address}}
{% endfor -%}
{% endif %}

export MANAGER_HOST=
{% if "slurm_master" in group_names %}
{% for host in groups['slurm_master']%}
={{host}}
{% endfor -%}
{% endif %}
{% if "pbs_master" in group_names %}
{% for host in groups['pbs_master']%}
={{host}}
{% endfor -%}
{% endif %}
{% if "slurm_worker" in group_names %}
{% for host in groups['slurm_master']%}
={{host}}
{% endfor -%}
{% endif %}
{% if "pbs_worker" in group_names %}
{% for host in groups['pbs_master']%}
={{host}}
{% endfor -%}
{% endif %}

export LOGIN_HOST=
{% if "slurm_master" in group_names %}
{% for host in groups['slurm_master']%}
={{host}}
{% endfor -%}
{% endif %}
{% if "pbs_master" in group_names %}
{% for host in groups['pbs_master']%}
={{host}}
{% endfor -%}
{% endif %}
{% if "slurm_worker" in group_names %}
{% for host in groups['slurm_master']%}
={{host}}
{% endfor -%}
{% endif %}
{% if "pbs_worker" in group_names %}
{% for host in groups['pbs_master']%}
={{host}}
{% endfor -%}
{% endif %}

export NODE_NAME={{inventory_hostname}}

export COMPUTE_HOSTLIST=
{% if "slurm_master" in group_names %}
{% for host in groups['slurm_worker']%}
={{host}}
{% endfor -%}
{% endif %}
{% if "pbs_master" in group_names %}
{% for host in groups['pbs_worker']%}
={{host}}
{% endfor -%}
{% endif %}
{% if "slurm_worker" in group_names %}
{% for host in groups['slurm_worker']%}
={{host}}
{% endfor -%}
{% endif %}
{% if "pbs_worker" in group_names %}
{% for host in groups['pbs_worker']%}
={{host}}
{% endfor -%}
{% endif %}
